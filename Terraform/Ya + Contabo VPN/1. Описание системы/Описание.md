### **Архитектура решиния**

Клиент Устройство → Yandex Cloud VPN Gateway → Contabo VPS (VPN-сервер) → Интернет

#### **Роль компонентов:**

- **Contabo VPS:** VPN-сервер (WireGuard/OpenVPN), выходит в интернет

- **Yandex Cloud:** VPN Gateway, точка входа в вашу инфраструктуру

- **Terraform:** управление всей конфигурацией как кодом
 
 ### **Архитектурная схема в Mermaid**
<br>    

```mermaid
graph TB
    subgraph "Yandex Cloud"
        subgraph VPC Network
            YC_VPN[VPN Gateway]
            YC_SUBNET[Subnet 192.168.10.0/24]
        end
    end
    
    subgraph "Contabo (Germany)"
        CONTABO_VPS[VPS Instance]
        WG_SERVER[WireGuard Server<br/>10.0.0.1]
    end
    
    subgraph "Internet Resources"
        STACKOVERFLOW[Stack Overflow]
        GITHUB[GitHub]
        DOCS[Technical Documentation]
    end
    
    USER[User in Russia] --> YC_VPN
    YC_VPN -- "IPSec Tunnel<br/>PSK Auth" --> CONTABO_VPS
    CONTABO_VPS --> WG_SERVER
    
    WG_SERVER --> STACKOVERFLOW
    WG_SERVER --> GITHUB
    WG_SERVER --> DOCS
    
    style USER fill:#e1f5fe
    style YC_VPN fill:#f3e5f5
    style CONTABO_VPS fill:#e8f5e8
    style WG_SERVER fill:#fff3e0
    style STACKOVERFLOW fill:#ffebee
```

### **Диаграмма последовательности**
<br>

```mermaid
sequenceDiagram
    participant U as User (Russia)
    participant Y as Yandex VPN Gateway
    participant C as Contabo VPS
    participant W as WireGuard
    participant I as Internet Resource

    Note over U,C: Phase 1: Установка соединения
    U->>Y: Подключение по VPN клиенту
    Y->>C: IPSec Tunnel (IKEv2 + PSK)
    C->>W: Маршрутизация в WireGuard
    W-->>C: Подтверждение
    
    Note over U,I: Phase 2: Рабочий трафик
    U->>Y: Запрос к stackoverflow.com
    Y->>C: Через IPSec туннель
    C->>W: Внутренняя маршрутизация
    W->>I: Исходящий запрос с IP Contabo
    I-->>W: Ответ от ресурса
    W->>C: Обратная маршрутизация
    C->>Y: Через IPSec туннель
    Y->>U: Доставка пользователю
```